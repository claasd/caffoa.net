using System;
using System.Collections.Generic;
using System.IO;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Caffoa;
using DemoV2.AspNetNewtonSoft.Model.Base;
using DemoV2.AspNetNewtonSoft.Model;

namespace DemoV2.AspNetNewtonSoft;

/// AUTOGENERATED BY caffoa
/// <summary>
/// Controller to be implemented to serve the api
/// </summary>
[ApiController]
[Route("api")]
public class DemoV2AspNetNewtonSoftMaintainanceController : ControllerBase
{
    private readonly ICaffoaFactory<IDemoV2AspNetNewtonSoftMaintainanceService> _factory;
    
    public DemoV2AspNetNewtonSoftMaintainanceController(ICaffoaFactory<IDemoV2AspNetNewtonSoftMaintainanceService> factory)
    {
        _factory = factory;
    }
    public IDemoV2AspNetNewtonSoftMaintainanceService GetService() => _factory.Instance(Request);

    /// <summary>
    /// start a long running function via durable functions
    /// 202 -> started long running function
    ///</summary>
    [HttpPost("startLongRunningFunction/{id}")]
    public async Task<ActionResult<ASPNLongRunningfunctionStatus>> LongRunningFunctionAsync([FromRoute] Guid id, CancellationToken cancellationToken = default) { return StatusCode(202, await GetService().LongRunningFunctionAsync(id, cancellationToken)); }


}